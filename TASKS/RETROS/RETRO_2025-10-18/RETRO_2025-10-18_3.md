# Retrospective: 2025-10-18

**5 plans analyzed. 6 patterns found.**

---

## Patterns (≥3 occurrences)

**Principle Violations:**
1. **Primitive/System boundary violations** (×3) - collision_responsibilities, gui_coupling, controller_input_coupling
   - Primitives knew gameplay concepts (grounded, slopes)
   - Systems directly modified by external layers (GUI → game state)
   - Global state polling in composable functions (input::)

2. **Accumulated state anti-pattern** (×3) - mouse_camera_jump, division_by_zero, collision_responsibilities
   - Conditionally updated state became stale (mouse position)
   - Division by accumulated values without epsilon checks
   - State interpretation mixed with resolution

3. **Global state coupling** (×3) - controller_input_coupling, gui_coupling, collision_responsibilities
   - Direct polling of input:: namespace
   - Bidirectional GUI ↔ game state coupling
   - Out-parameter state modification

**Workflow Success:**
- All 5/5 plans completed smoothly
- No friction in REFINE process
- Codex second opinion used effectively (2/5 plans)
- Standard workflow functioning correctly

**Documentation Bloat:**
1. **Trivial refinements over-documented** (×3) - mouse_camera_jump (119:1), division_by_zero (53:1)
   - Extreme ratios: 238 LOC documenting 2 LOC change
   - Violates Radical Simplicity in documentation itself
   - Metrics repeated across multiple sections

2. **Standard refinements bloated** (×2) - collision_responsibilities (45:1), controller_input_coupling (21:1)
   - Acceptable content but repetitive structure
   - Same information stated multiple ways

**Deferred (<3 occurrences):**
- None

---

## Important Ideas from Plans

**Dual Reference Pattern** (collision_responsibilities):
- Primitives return rich data structures
- Systems interpret data using game logic
- Clean separation: physics ← → gameplay
- **Action:** Create PRIMITIVES_GUIDE.md

**Controller Pattern** (controller_input_coupling):
- Any input transform should accept explicit data
- Never poll globals in composable functions
- Pure function: input struct → state update
- **Generalization:** Applies to AI, replay, network

**Command Pattern for External Systems** (gui_coupling):
- GUI/Network/Scripting emit commands, never modify state
- Unidirectional flow: state → display, commands → state
- **Generalization:** All external→internal transitions

**Accumulated State Prevention** (mouse_camera_jump):
- Never conditionally update accumulated state
- Either always update (stay fresh) or derive from truth
- State that drifts becomes lies
- **Action:** Create ACCUMULATED_STATE.md

---

## Actions

**Context Files (COMMON):**
- Create `ACCUMULATED_STATE.md` - Technical guide on pattern, epsilon checks, conditional update dangers
- Create `PRIMITIVES_GUIDE.md` - Dual reference, data vs interpretation, boundary rules
- Inject both into CLAUDE.md (high-value patterns affecting multiple systems)

**Workflow Updates (COMMON):**
- `TASKS/REFINE.md`: Add documentation ratio limits (trivial ≤10:1, standard ≤5:1)
- `TASKS/REFINE.md`: Add "Delete > Simplify > Document" reminder
- `TASKS/SELECT.md`: Add bloat check to completion criteria

**Backlog Updates (COMMON):**
- Add refinement: "Input system modifies camera" (mentioned in collision_responsibilities:314)
- Priority: Medium (primitive/system boundary violation)

**PRINCIPLES.md Updates (RARE):**
- None - principles are correct, technical details belong in context files

---

## Summary

- Patterns: 6 (3 principle violations, 1 workflow success, 2 documentation issues)
- Important Ideas: 4 (dual reference, controller pattern, command pattern, accumulated state)
- Actions: 2 context files, 2 workflow updates, 1 backlog addition
- Execute: Context files first (prevent future violations), then workflow updates (prevent bloat)

**Is workflow working?** Yes. 5/5 plans completed smoothly, no friction in REFINE process. Codex integration effective. Focus now on preventing documentation bloat and capturing technical patterns to avoid repeating violations.

**Documentation bloat is the main issue** - plans violate Radical Simplicity they're documenting. Workflow updates will enforce ratios and remind to delete > simplify > document.

---
